{
  "packagingVersion": "3.0",
  "name": "bitbucket",
  "version": "4.5",
  "releaseVersion": 3,
  "description": "Bitbucket Server gives you secure, fast, enterprise-grade controls, like fine-grained permissions and powerful management features.",
  "maintainer": "support@mesosphere.io",
  "tags": [ "git", "bitbucket", "bit", "bucket", "vcs", "scm" ],
  "resource": {
    "images": {
      "icon-small": "http://i.imgur.com/QGc420u.png",
      "icon-medium": "http://i.imgur.com/QGc420u.png",
      "icon-large": "http://i.imgur.com/QGc420u.png"
    },
    "assets": {
      "container": {
        "docker": {
          "bitbucket-docker": "atlassian/bitbucket-server:4.5"
        }
      }
    }
  },
  "config": {
    "$schema": "http://json-schema.org/schema#",
    "properties": {
      "bitbucket": {
        "properties": {
          "instances": {
            "default": 1,
            "description": "Number of instances to run.",
            "minimum": 1,
            "type": "integer"
          },
          "cpus": {
            "default": 2,
            "description": "CPU shares to allocate to each bitbucket instance.",
            "minimum": 2,
            "type": "number"
          },
          "host-volume": {
            "description": "The location of a volume on the host to be used for persisting Bitbucket data. The final location will be derived from this value plus the name set in `name` (e.g. `/mnt/host_volume/bitbucket`). Note that this path must be the same on all DCOS agents.",
            "type": "string",
            "default": "/tmp"
          },
          "mem": {
            "default": 2048.0,
            "description": "Memory (MB) to allocate to each bitbucket task.",
            "minimum": 2048.0,
            "type": "number"
          },
          "minimumHealthCapacity": {
            "default": 0.5,
            "description": "Minimum health capacity.",
            "minimum": 0,
            "type": "number"
          },
          "maximumOverCapacity": {
            "default": 0.2,
            "description": "Maximum over capacity.",
            "minimum": 0,
            "type": "number"
          },
          "name": {
            "default": "bitbucket",
            "description": "Name for this bitbucket application",
            "type": "string"
          },
          "role": {
            "default": "*",
            "description": "Deploy bitbucket only on nodes with this role.",
            "type": "string"
          },
          "virtual-host": {
            "description": "The virtual host address to configure for integration with Marathon-lb.",
            "type": "string"
          }
        },
        "required": ["cpus", "mem", "instances", "name"],
        "type": "object"
      }
    },
    "type": "object"
  },
  "marathon": {
    "v2AppMustacheTemplate": "ewogICJpZCI6ICIve3tiaXRidWNrZXQubmFtZX19IiwKICAiaW5zdGFuY2VzIjoge3tiaXRidWNrZXQuaW5zdGFuY2VzfX0sCiAgImNwdXMiOiB7e2JpdGJ1Y2tldC5jcHVzfX0sCiAgIm1lbSI6IHt7Yml0YnVja2V0Lm1lbX19LAogICJtYWludGFpbmVyIjogInN1cHBvcnRAbWVzb3NwaGVyZS5pbyIsCiAgImNvbnRhaW5lciI6IHsKICAgICJ0eXBlIjogIkRPQ0tFUiIsCiAgICAiZG9ja2VyIjogewogICAgICAiaW1hZ2UiOiAie3tyZXNvdXJjZS5hc3NldHMuY29udGFpbmVyLmRvY2tlci5iaXRidWNrZXQtZG9ja2VyfX0iLAogICAgICAibmV0d29yayI6ICJCUklER0UiLAogICAgICAicG9ydE1hcHBpbmdzIjogWwogICAgICAgIHsgImNvbnRhaW5lclBvcnQiOiA3OTkwLCAiaG9zdFBvcnQiOiAwIH0sCiAgICAgICAgeyAiY29udGFpbmVyUG9ydCI6IDc5OTksICJob3N0UG9ydCI6IDAgfQogICAgICBdCiAgICB9LAogICAgInZvbHVtZXMiOiBbCiAgICB7CiAgICAgICAgImNvbnRhaW5lclBhdGgiOiAiL3Zhci9hdGxhc3NpYW4vYXBwbGljYXRpb24tZGF0YS9iaXRidWNrZXQiLAogICAgICAgICJob3N0UGF0aCI6ICJ7e2JpdGJ1Y2tldC5ob3N0LXZvbHVtZX19IiwKICAgICAgICAibW9kZSI6ICJSVyIKICAgIH0KICAgIF0KICB9LAogICJoZWFsdGhDaGVja3MiOiBbCiAgICB7CiAgICAgICJwcm90b2NvbCI6ICJDT01NQU5EIiwKICAgICAgImNvbW1hbmQiOiB7ICJ2YWx1ZSI6ICJjdXJsIC0tZmFpbCAke0hPU1R9OiR7UE9SVDB9IiB9LAogICAgICAiZ3JhY2VQZXJpb2RTZWNvbmRzIjogMzAwLAogICAgICAiaW50ZXJ2YWxTZWNvbmRzIjogNjAsCiAgICAgICJ0aW1lb3V0U2Vjb25kcyI6IDIwLAogICAgICAibWF4Q29uc2VjdXRpdmVGYWlsdXJlcyI6IDMKICAgIH0KICBdLAogICJhY2NlcHRlZFJlc291cmNlUm9sZXMiOiBbCiAgICAie3tiaXRidWNrZXQucm9sZX19IgogIF0sCiAgImxhYmVscyI6IHsKICAgIHt7I2JpdGJ1Y2tldC52aXJ0dWFsLWhvc3R9fQogICAgIkhBUFJPWFlfR1JPVVAiOiJleHRlcm5hbCIsCiAgICAiSEFQUk9YWV8wX1ZIT1NUIjoie3tiaXRidWNrZXQudmlydHVhbC1ob3N0fX0iLAogICAge3svYml0YnVja2V0LnZpcnR1YWwtaG9zdH19CiAgICAiRENPU19TRVJWSUNFX05BTUUiOiAie3tiaXRidWNrZXQubmFtZX19IiwKICAgICJEQ09TX1NFUlZJQ0VfU0NIRU1FIjogImh0dHAiLAogICAgIkRDT1NfU0VSVklDRV9QT1JUX0lOREVYIjogIjAiCiAgfQp9Cg=="
  }
}
